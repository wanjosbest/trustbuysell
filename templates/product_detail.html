{% extends "base.html" %}

{% load static %}
{% block header %}
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}Product Details {% endblock %}</title>
<link rel="stylesheet" href="{% static 'css/products.css' %}">
{% include "header.html"%}

{% endblock %}

{% block content %}
<main>

  <!-- Product Gallery -->
  <section class="gallery">
    <img id="mainImage" src="{{ product.product_image.image.url }}" alt="{{ product.name }}">
  </section>
  <div class="thumbs">
    {% if product.product_image %}<img src="{{ product.product_image.image.url }}" class="active">{% endif %}
    {% if product.product_image2 %}<img src="{{ product.product_image2.image.url }}">{% endif %}
    {% if product.product_image3 %}<img src="{{ product.product_image3.image.url }}">{% endif %}
  </div>

  <!-- Product Info -->
  <section class="info">
    <h1>{{ product.name }}</h1>
    <div class="seller">by <strong>{{ product.user }}</strong></div>
    <div class="price">â‚¦{{ product.discountedprice }}</div>

    <div class="actions">
      <a href="tel:{{ product.user.phone_number }}" class="btn btn-accent">ðŸ“ž Call Seller</a>
      <a href="{% url 'add-to-cart' product.id %}" class="btn btn-primary">Add to Cart</a>
    </div>
  </section>

  <!-- Description -->
  <section class="desc">
    <h2>Product Description</h2>
    <p>{{ product.description }}</p>
  </section>

  <!-- Related Products -->
  <section class="related">
    <h2>Related Products</h2>
    <div class="rel-grid">
      {% for related in related_product %}
      <div class="rel-card">
        <img src="{{ related.product_image.image.url }}" alt="{{ related.name }}">
        <div class="body">
          <div class="title">{{ related.name }}</div>
          <div class="price">â‚¦{{ related.discountedprice }}</div>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>

</main>

<script>
const thumbs = document.querySelectorAll('.thumbs img');
const mainImage = document.getElementById('mainImage');
thumbs.forEach(t => {
  t.addEventListener('click', () => {
    thumbs.forEach(x => x.classList.remove('active'));
    t.classList.add('active');
    mainImage.src = t.src;
  });
});
</script>

{% endblock %}
