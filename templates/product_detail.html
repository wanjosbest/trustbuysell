<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>TrustBuySell — Product Details</title>
<style>
  :root{
    --primary:#1E3A8A;
    --accent:#F97316;
    --bg:#f4f6fb;
    --card:#fff;
    --muted:#6b7280;
    --max-w:1200px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Inter, system-ui, Arial, sans-serif;
    background:var(--bg);
    color:#0f172a;
    -webkit-font-smoothing:antialiased;
  }
  a{color:inherit}

  /* ---------- HEADER (same as your homepage) ---------- */
  header{
    position:sticky;
    top:0;
    z-index:1200;
    background:linear-gradient(90deg,var(--primary),#12306b);
    box-shadow:0 4px 16px rgba(2,6,23,.12);
  }
  .nav{
    max-width:var(--max-w);
    margin:0 auto;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:12px 16px;
    gap:12px;
  }
  .brand{color:#fff;font-weight:800;font-size:1.15rem;letter-spacing:.3px}
  .nav-right{display:flex;align-items:center;gap:12px}
  .search{
    display:flex;align-items:center;background:#fff;padding:6px 8px;border-radius:999px;
    min-width:200px;max-width:420px;box-shadow:0 6px 20px rgba(2,6,23,0.06)
  }
  .search input{border:0;outline:none;font-size:0.95rem;padding:8px;width:100%;background:transparent}
  .search button{background:var(--accent);border:0;color:#fff;padding:8px 10px;border-radius:999px;cursor:pointer;font-weight:700}
  .links{display:flex;gap:12px;align-items:center}
  .links a{color:#fff;padding:8px 10px;border-radius:8px;font-weight:700}
  .cta-sell{background:var(--accent);color:#fff;padding:8px 12px;border-radius:8px;font-weight:800}
  .hamb{display:none;font-size:1.6rem;padding:8px;border-radius:8px;background:rgba(255,255,255,0.06);color:#fff;cursor:pointer;border:0}

  /* mobile nav overlay */
  .mobile-nav { display:none; position:fixed; inset:64px 0 0 0; background:linear-gradient(180deg,#123d6b,#0c2945); color:#fff; z-index:1199; padding:20px; overflow:auto; }
  .mobile-nav.open{ display:block; }

  /* ---------- HERO (image loop) ---------- */
  .hero-wrap{max-width:var(--max-w);margin:14px auto;position:relative;border-radius:12px;overflow:hidden;box-shadow:0 12px 40px rgba(2,6,23,0.08)}
  .hero{position:relative;height:46vh;min-height:240px;background:#dbeafe}
  .hero img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity .6s ease}
  .hero img.active{opacity:1}

  /* ---------- PRODUCT LAYOUT ---------- */
  main{max-width:var(--max-w);margin:18px auto;padding:0 16px;display:grid;gap:18px}
  .product-area{display:grid;grid-template-columns: 1fr 380px;gap:20px;align-items:start}
  @media(max-width:980px){ .product-area{grid-template-columns:1fr} }

  .gallery{background:var(--card);padding:12px;border-radius:12px;box-shadow:0 8px 24px rgba(2,6,23,.06)}
  .main-image{width:100%;height:420px;background:#f6f9ff;border-radius:10px;overflow:hidden;display:flex;align-items:center;justify-content:center}
  .main-image img{max-width:100%;max-height:100%;object-fit:contain;transition:transform .2s ease}
  .thumb-row{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
  .thumb{width:72px;height:72px;border-radius:8px;overflow:hidden;cursor:pointer;border:1px solid #eee}
  .thumb img{width:100%;height:100%;object-fit:cover}

  .product-meta{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 8px 24px rgba(2,6,23,.06)}
  .title{font-size:1.25rem;font-weight:700;margin-bottom:6px}
  .meta-row{display:flex;gap:8px;align-items:center;color:var(--muted);font-size:14px;margin-bottom:12px}
  .rating{color:#f5b400}
  .price{color:var(--primary);font-size:1.5rem;font-weight:800;margin:6px 0}
  .stock{font-weight:700;color:green;margin-left:8px}
  .seller{font-size:13px;color:var(--muted);margin-top:6px}

  .variants{display:flex;gap:10px;flex-wrap:wrap;margin:12px 0}
  .variant-btn{background:#f3f4f6;border:1px solid #e6e9ef;padding:8px 12px;border-radius:8px;cursor:pointer}
  .variant-btn.active{border-color:var(--primary);box-shadow:0 2px 8px rgba(30,58,138,0.08);background:#fff}

  .qty-row{display:flex;align-items:center;gap:10px;margin-top:12px}
  .qty-btn{width:36px;height:36px;border-radius:8px;border:1px solid #e6e9ef;background:#fff;cursor:pointer;font-size:18px}
  .qty-input{width:64px;padding:8px;text-align:center;border-radius:8px;border:1px solid #e6e9ef}

  .actions{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
  .btn{padding:10px 14px;border-radius:10px;border:0;cursor:pointer}
  .btn-primary{background:var(--accent);color:#fff;font-weight:800}
  .btn-ghost{background:transparent;border:1px solid rgba(15,23,42,0.06)}

  /* sticky CTA (mobile) */
  .sticky-cta{display:none;position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid #eee;padding:10px 16px;box-shadow:0 -6px 20px rgba(2,6,23,0.06);z-index:1400}
  .sticky-cta .bar{display:flex;gap:8px;align-items:center;justify-content:space-between}
  .sticky-cta .bar .left{display:flex;gap:8px;align-items:center}
  @media(max-width:720px){ .sticky-cta{display:block} .hero{min-height:160px} .main-image{height:260px} }

  /* tabs */
  .tabs{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 8px 24px rgba(2,6,23,.04)}
  .tab-buttons{display:flex;gap:8px;border-bottom:1px solid #eef2f7;padding-bottom:8px;margin-bottom:12px;flex-wrap:wrap}
  .tab-btn{padding:8px 12px;border-radius:8px;background:transparent;border:0;cursor:pointer;font-weight:700}
  .tab-btn.active{background:#f9fafb;border:1px solid #eef2f7}
  .tab-content{display:none}
  .tab-content.active{display:block}

  /* reviews */
  .review-card{background:#fff;padding:12px;border-radius:8px;border:1px solid #eef2f7;margin-bottom:10px}
  .review-form textarea{width:100%;min-height:90px;padding:10px;border-radius:8px;border:1px solid #e6e9ef}

  /* related */
  .related-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px}
  .related-card{background:var(--card);padding:10px;border-radius:8px;text-align:center;border:1px solid #eef2f7}
  .related-card img{width:100%;height:140px;object-fit:cover;border-radius:8px}

  /* wishlist + share + chat */
  .tools{display:flex;gap:8px;margin-top:12px}
  .tool-btn{background:#fff;border:1px solid #eef2f7;padding:8px;border-radius:8px;cursor:pointer}

  /* small screens */
  @media(max-width:720px){
    .nav .links{display:none}
    .hamb{display:block}
    .nav-right{gap:8px}
    .search{min-width:120px}
  }

  /* focus */
  button:focus,input:focus,select:focus{outline:3px solid rgba(249,115,22,0.14);outline-offset:2px}
</style>
</head>
<body>

<!-- HEADER (same navbar) -->
<header>
  <div class="nav" role="navigation" aria-label="Main">
    <div style="display:flex;align-items:center;gap:12px">
      <div class="brand">TrustBuySell</div>
      <button class="hamb" id="hambBtn" aria-label="Open menu">☰</button>
      <div class="links" id="topLinks" style="display:flex;gap:8px">
        <a href="#featured" style="color:#fff;padding:8px 10px;border-radius:8px">Home</a>
        <a href="#categories" style="color:#fff;padding:8px 10px;border-radius:8px">Shop</a>
      </div>
    </div>

    <div class="nav-right" style="align-items:center">
      <div class="search" role="search" aria-label="Search products">
        <input id="globalSearch" placeholder="Search products, categories, sellers..." aria-label="Search products" />
        <button id="searchBtn">Search</button>
      </div>
      <a class="cta-sell" href="#register" id="startSellingBtn">Start Selling</a>
    </div>
  </div>

  <div id="mobileNav" class="mobile-nav" aria-hidden="true">
    <div style="display:flex;flex-direction:column;gap:12px;max-width:420px;margin:0 auto">
      <a href="#featured">Home</a>
      <a href="#categories">Shop</a>
      <a href="#register">Sell on TrustBuySell</a>
      <a href="#contact">Contact</a>
    </div>
  </div>
</header>

<!-- HERO (loops hero images) -->
<div class="hero-wrap" aria-hidden="false">
  <div class="hero" id="hero">
    <img src="{{product.product_image.image.url}}" class="active" alt="Hero slide 1">
    <img src="{{product.product_image2.image.url}}" alt="Hero slide 2">
    <img src="{{product.product_image3.image.url}}" alt="Hero slide 3">
  </div>
</div>

<main>
  <div class="product-area" role="main" aria-labelledby="productTitle">

    <!-- Left: Gallery + tabs -->
    <section style="display:flex;flex-direction:column;gap:12px">
      <div class="gallery" aria-label="Product gallery">
        <div class="main-image" id="mainImageWrap" aria-live="polite">
          <img id="mainImage" src="{{product.product_image.image.url}}" alt="Main product image">
        </div>
        <div class="thumb-row" role="list">
          <!-- Using hero images for thumbnails as requested -->
          <div class="thumb" role="listitem" data-src="{{product.product_image.image.url}}"><img src="{{product.product_image.image.url}}" alt="{{product.name}}"></div>
          <div class="thumb" role="listitem" data-src="{{product.product_image2.image.url}}"><img src="{{product.product_image2.image.url}}" alt="{{product.name}}"></div>
          <div class="thumb" role="listitem" data-src="{{product.product_image3.image.url}}"><img src="{{product.product_image3.image.url}}" alt="{{product.name}}"></div>
        </div>
      </div>

      <!-- Tabs: Description, Specs, Reviews, FAQ -->
      <div class="tabs" id="tabs">
        <div class="tab-buttons" role="tablist" aria-label="Product information tabs">
          <button class="tab-btn active" data-tab="desc" role="tab" aria-selected="true">Description</button>
          <button class="tab-btn" data-tab="specs" role="tab" aria-selected="false">Specifications</button>
          <button class="tab-btn" data-tab="reviews" role="tab" aria-selected="false">Reviews (12)</button>
          <button class="tab-btn" data-tab="faq" role="tab" aria-selected="false">FAQ</button>
        </div>

        <div class="tab-content active" id="desc">
          <h3>Product Details</h3>
          <p>{{product.description}}</p>
        </div>

        <div class="tab-content" id="specs">
          <h3>Specifications</h3>
          <ul>
            <li>Brand: TrustBuySell Select</li>
            <li>Model: TBS-2025</li>
            <li>Color options: multiple</li>
            <li>Warranty: 6 months</li>
          </ul>
        </div>

        <div class="tab-content" id="reviews">
          <div id="reviewsList">
            <!-- sample reviews -->
            <div class="review-card"><strong>Fatima</strong> — <span style="color:var(--muted)">Seller</span><p style="margin:6px 0;color:var(--muted)">Very satisfied. Fast delivery.</p></div>
            <div class="review-card"><strong>Ali</strong><p style="margin:6px 0;color:var(--muted)">Excellent product, recommended.</p></div>
          </div>

          <div style="margin-top:12px" class="review-form" aria-label="Write a review">
            <h4>Write a review</h4>
            <input id="reviewName" placeholder="Your name" style="width:100%;padding:8px;border-radius:8px;border:1px solid #e6e9ef;margin-bottom:8px">
            <textarea id="reviewText" placeholder="Your review" style="width:100%;padding:8px;border-radius:8px;border:1px solid #e6e9ef"></textarea>
            <div style="display:flex;gap:8px;margin-top:8px">
              <button class="btn btn-primary" id="submitReview">Submit review</button>
              <button class="btn btn-ghost" onclick="document.getElementById('reviewText').value='';document.getElementById('reviewName').value=''">Clear</button>
            </div>
          </div>
        </div>

        <div class="tab-content" id="faq">
          <h3>FAQ</h3>
          <p><strong>Q:</strong> What is the delivery time?<br><strong>A:</strong> Delivery across Adamawa: 1-3 days depending on location.</p>
        </div>
      </div>
    </section>

    <!-- Right: Product meta + actions -->
    <aside class="product-meta" aria-label="Purchase information">
      <div class="title" id="productTitle">{{product.name}}</div>
      <div class="meta-row"><div class="rating">★★★★☆</div><div style="color:var(--muted)"> (12 reviews)</div></div>
      <div class="price" id="price">₦{{product.discountedprice}}</div>
      <div class="meta-row">Availability: <span id="stock" class="stock">In stock</span></div>
      <div class="seller">Sold by <strong>{{product.user}}</strong> • <a href="#" style="color:var(--primary)">Visit store</a></div>

      <!-- variants -->
      <div style="margin-top:12px"><strong>Color</strong>
        <div class="variants" id="colorVariants">
          <button class="variant-btn active" data-image="hero1.jpg" data-price="3500">Yellow</button>
          <button class="variant-btn" data-image="hero2.jpg" data-price="3600">Black</button>
          <button class="variant-btn" data-image="hero3.jpg" data-price="3700">Blue</button>
        </div>
      </div>

      <div style="margin-top:8px"><strong>Size</strong>
        <div class="variants" id="sizeVariants">
          <button class="variant-btn active" data-price="3500">Small</button>
          <button class="variant-btn" data-price="3800">Medium</button>
          <button class="variant-btn" data-price="4200">Large</button>
        </div>
      </div>

      <!-- quantity -->
      <div class="qty-row" aria-label="Quantity selector">
        <button class="qty-btn" id="qtyMinus" aria-label="Decrease quantity">−</button>
        <input aria-label="Quantity" class="qty-input" id="qtyInput" type="number" min="1" value="1">
        <button class="qty-btn" id="qtyPlus" aria-label="Increase quantity">+</button>
      </div>

      <!-- wishlist, share -->
      <div class="tools" role="toolbar" aria-label="Product actions">
        <button class="tool-btn" id="wishlistBtn">♡ Wishlist</button>
        <button class="tool-btn" id="shareBtn">⤴ Share</button>
      </div>

      <!-- actions -->
      <div class="actions" role="group" aria-label="Buy actions">
        <button class="btn btn-primary" id="addCart">Add to Cart</button>
        <button class="btn btn-ghost" id="buyNow">Buy Now</button>
      </div>

      <!-- shipping / guarantees -->
      <div style="margin-top:14px;font-size:14px;color:var(--muted)">
        <div>✅ Secure payments</div>
        <div>🚚 Local delivery across Adamawa</div>
        <div>🔒 6 months seller warranty</div>
      </div>
    </aside>
  </div>

  <!-- Related products -->
  <section class="tabs">
    <h3 style="margin:0 0 12px">Related Products</h3>
    <div class="related-grid" id="relatedGrid">
      {% for related in related_product %}
      <div class="related-card"><img src="{{related.product_image.image.url}}" alt="{{related.name}}"><div style="padding:8px"><strong>{{related.name}}</strong><div style="color:var(--muted)">₦4,500</div></div></div>
      {% endfor %}
    </div>
  </section>

</main>

<!-- Sticky CTA bar for mobile -->
<div class="sticky-cta" role="region" aria-label="Quick actions">
  <div class="bar">
    <div class="left">
      <div style="font-weight:800">₦<span id="stickyPrice">3,500</span></div>
      <div style="color:var(--muted);font-size:13px">Qty: <span id="stickyQty">1</span></div>
    </div>
    <div style="display:flex;gap:8px">
      <button class="btn btn-ghost" id="stickyCart">Cart</button>
      <button class="btn btn-primary" id="stickyBuy">Buy</button>
    </div>
  </div>
</div>

<!-- Live chat floating button (UI only) -->
<button id="liveChat" aria-label="Chat" style="position:fixed;right:16px;bottom:84px;background:var(--primary);color:#fff;border:0;padding:12px;border-radius:999px;box-shadow:0 8px 24px rgba(2,6,23,.12);z-index:1500">💬 Chat</button>

<script>
/* ---------- Mobile nav toggle ---------- */
const hamb = document.getElementById('hambBtn');
const mobileNav = document.getElementById('mobileNav');
hamb.addEventListener('click', () => {
  const open = mobileNav.classList.toggle('open');
  mobileNav.setAttribute('aria-hidden', !open);
  if(open){ document.body.style.overflow='hidden'; } else { document.body.style.overflow=''; }
});
window.addEventListener('resize', ()=> { if(window.innerWidth>900){ mobileNav.classList.remove('open'); mobileNav.setAttribute('aria-hidden','true'); document.body.style.overflow=''; } });

/* ---------- Hero slideshow (loops your hero images) ---------- */
const heroImgs = Array.from(document.querySelectorAll('.hero img'));
let heroIndex = 0;
function showHero(i){
  heroImgs.forEach((img,idx)=> img.classList.toggle('active', idx===i));
}
function nextHero(){ heroIndex=(heroIndex+1)%heroImgs.length; showHero(heroIndex); }
let heroTimer = setInterval(nextHero,3500);

/* pause on hover for accessibility */
document.getElementById('hero').addEventListener('mouseenter', ()=> clearInterval(heroTimer));
document.getElementById('hero').addEventListener('mouseleave', ()=> { clearInterval(heroTimer); heroTimer = setInterval(nextHero,3500); });

/* ---------- Gallery thumbnails ---------- */
const thumbEls = document.querySelectorAll('.thumb');
const mainImage = document.getElementById('mainImage');
thumbEls.forEach(t => {
  t.addEventListener('click', ()=> {
    const src = t.getAttribute('data-src');
    mainImage.src = src;
    // also set hero to same image for visual consistency
    heroImgs.forEach(img=>{ if(img.src.includes(src)) showHero(heroImgs.indexOf(img)); });
  });
});

/* zoom on hover (desktop) */
const mainWrap = document.getElementById('mainImageWrap');
mainWrap.addEventListener('mousemove', (e)=> {
  if(window.innerWidth < 720) return;
  const img = mainImage;
  const rect = img.getBoundingClientRect();
  const x = (e.clientX - rect.left) / rect.width * 100;
  const y = (e.clientY - rect.top) / rect.height * 100;
  img.style.transformOrigin = `${x}% ${y}%`;
  img.style.transform = 'scale(1.8)';
});
mainWrap.addEventListener('mouseleave', ()=> { mainImage.style.transform='scale(1)'; mainImage.style.transformOrigin='center'; });

/* ---------- Variants: color/size selection updates price & image ---------- */
function clearActive(container){
  container.querySelectorAll('.variant-btn').forEach(b=>b.classList.remove('active'));
}
const colorVars = document.getElementById('colorVariants');
const sizeVars = document.getElementById('sizeVariants');
const priceEl = document.getElementById('price');
const stickyPrice = document.getElementById('stickyPrice');

colorVars.addEventListener('click', (e)=>{
  const btn = e.target.closest('.variant-btn');
  if(!btn) return;
  clearActive(colorVars);
  btn.classList.add('active');
  const newImage = btn.dataset.image;
  if(newImage) mainImage.src = newImage;
  // update base price from data-price if present
  if(btn.dataset.price) { priceEl.textContent = '₦' + numberWithCommas(btn.dataset.price); stickyPrice.textContent = numberWithCommas(btn.dataset.price); }
});

sizeVars.addEventListener('click', (e)=>{
  const btn = e.target.closest('.variant-btn');
  if(!btn) return;
  clearActive(sizeVars);
  btn.classList.add('active');
  if(btn.dataset.price) { priceEl.textContent = '₦' + numberWithCommas(btn.dataset.price); stickyPrice.textContent = numberWithCommas(btn.dataset.price); }
});

/* ---------- Quantity +/- ---------- */
const qtyInput = document.getElementById('qtyInput');
const qtyMinus = document.getElementById('qtyMinus');
const qtyPlus = document.getElementById('qtyPlus');
const stickyQty = document.getElementById('stickyQty');

function clampQty(v){ return Math.max(1, Math.floor(v)); }
qtyMinus.addEventListener('click', ()=> { qtyInput.value = clampQty(Number(qtyInput.value)-1); stickyQty.textContent = qtyInput.value; });
qtyPlus.addEventListener('click', ()=> { qtyInput.value = clampQty(Number(qtyInput.value)+1); stickyQty.textContent = qtyInput.value; });
qtyInput.addEventListener('change', ()=> { qtyInput.value = clampQty(Number(qtyInput.value)); stickyQty.textContent = qtyInput.value; });

/* ---------- Wishlist toggle ---------- */
const wishlistBtn = document.getElementById('wishlistBtn');
let wished = false;
wishlistBtn.addEventListener('click', ()=> {
  wished = !wished;
  wishlistBtn.textContent = wished ? '♥ Wishlisted' : '♡ Wishlist';
  wishlistBtn.style.background = wished ? '#fff0ea' : '#fff';
});

/* ---------- Add to cart / Buy now (demo) ---------- */
const addCartBtn = document.getElementById('addCart');
const buyNowBtn = document.getElementById('buyNow');
addCartBtn.addEventListener('click', ()=> {
  const qty = qtyInput.value;
  alert(`Added ${qty} item(s) to cart — demo. Implement cart logic with your DRF backend.`);
});
buyNowBtn.addEventListener('click', ()=> {
  const qty = qtyInput.value;
  alert(`Proceed to buy ${qty} item(s) — demo. Implement checkout with Paystack/Flutterwave.`);
});
document.getElementById('stickyBuy').addEventListener('click', ()=> buyNowBtn.click());
document.getElementById('stickyCart').addEventListener('click', ()=> addCartBtn.click());

/* ---------- Share (UI) ---------- */
document.getElementById('shareBtn').addEventListener('click', async ()=> {
  const url = location.href;
  if(navigator.share){
    try{ await navigator.share({title:document.getElementById('productTitle').textContent, url}); }
    catch(e){ alert('Share cancelled'); }
  } else {
    prompt('Copy product link', url);
  }
});

/* ---------- Tabs behavior ---------- */
document.querySelectorAll('.tab-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.tab-btn').forEach(b=>{ b.classList.remove('active'); b.setAttribute('aria-selected','false'); });
    btn.classList.add('active'); btn.setAttribute('aria-selected','true');
    const tab = btn.dataset.tab;
    document.querySelectorAll('.tab-content').forEach(tc=>tc.classList.remove('active'));
    document.getElementById(tab).classList.add('active');
  });
});

/* ---------- Reviews submit (client demo) ---------- */
document.getElementById('submitReview').addEventListener('click', ()=>{
  const name = document.getElementById('reviewName').value.trim() || 'Anonymous';
  const text = document.getElementById('reviewText').value.trim();
  if(!text) return alert('Write a short review first');
  const node = document.createElement('div');
  node.className = 'review-card';
  node.innerHTML = `<strong>${escapeHtml(name)}</strong><p style="margin:6px 0;color:var(--muted)">${escapeHtml(text)}</p>`;
  document.getElementById('reviewsList').prepend(node);
  document.getElementById('reviewName').value=''; document.getElementById('reviewText').value='';
  alert('Thanks! Your review was submitted (demo)');
});

/* ---------- Utilities ---------- */
function numberWithCommas(n){ return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","); }
function escapeHtml(s){ return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

/* ---------- Small accessibility / performance tweaks ---------- */
document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape'){ mobileNav.classList.remove('open'); mobileNav.setAttribute('aria-hidden','true'); } });

</script>
</body>
</html>
